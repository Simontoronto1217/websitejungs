<!DOCTYPE html>
<html lang="de" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHRONEXT Intervention Command Center</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Alpine.js Plugins -->
    <script defer src="https://unpkg.com/@alpinejs/collapse@3.13.3/dist/cdn.min.js"></script>
    <script defer src="https://unpkg.com/alpinejs@3.13.3/dist/cdn.min.js"></script>
    
    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'chronext': {
                            'dark': '#0a0a0f',
                            'anthracite': '#1a1a24',
                            'navy': '#0d1b2a',
                            'platinum': '#e5e4e2',
                            'rosegold': '#b76e79',
                            'crimson': '#8b0000',
                            'gold': '#d4af37',
                        }
                    },
                    fontFamily: {
                        'cinzel': ['Cinzel', 'serif'],
                        'inter': ['Inter', 'sans-serif'],
                    },
                    backdropBlur: {
                        'xs': '2px',
                    }
                }
            }
        }
    </script>
    
    <style>
        [x-cloak] { display: none !important; }
        [data-hydration-error] { display: none !important; }
        
        body {
            background: #0a0a0f;
            font-family: 'Inter', sans-serif;
        }
        
        .glassmorphism {
            background: rgba(26, 26, 36, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(229, 228, 226, 0.1);
        }
        
        .glassmorphism-light {
            background: rgba(229, 228, 226, 0.05);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(229, 228, 226, 0.08);
        }
        
        .text-gradient-gold {
            background: linear-gradient(135deg, #d4af37 0%, #f4e5c3 50%, #d4af37 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .pulse-critical {
            animation: pulse-crimson 2s infinite;
        }
        
        @keyframes pulse-crimson {
            0%, 100% { box-shadow: 0 0 0 0 rgba(139, 0, 0, 0.4); }
            50% { box-shadow: 0 0 20px 10px rgba(139, 0, 0, 0.2); }
        }
        
        .pulse-warning {
            animation: pulse-rosegold 2.5s infinite;
        }
        
        @keyframes pulse-rosegold {
            0%, 100% { box-shadow: 0 0 0 0 rgba(183, 110, 121, 0.3); }
            50% { box-shadow: 0 0 15px 5px rgba(183, 110, 121, 0.15); }
        }
        
        .magnetic-btn {
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .magnetic-btn:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 10px 40px rgba(212, 175, 55, 0.15);
        }
        
        .ticket-card {
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .ticket-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        }
        
        #sisyphus-container {
            position: fixed;
            bottom: 0;
            right: 0;
            width: 300px;
            height: 400px;
            pointer-events: none;
            z-index: 10;
        }
        
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .copy-notification {
            animation: slideUp 0.3s ease-out;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Easter Egg Glass Shatter */
        .glass-shatter {
            animation: shatter 1.5s ease-out forwards;
        }
        
        @keyframes shatter {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
            100% { opacity: 0; transform: scale(0.8) rotate(5deg); }
        }
        
        .category-badge {
            font-size: 0.65rem;
            letter-spacing: 0.1em;
        }
    </style>
</head>
<body class="min-h-screen text-chronext-platinum overflow-x-hidden" x-data="interventionDashboard()" x-init="init()">
    
    <!-- Three.js Background Canvas -->
    <canvas id="bg-canvas" class="fixed inset-0 w-full h-full -z-10"></canvas>
    
    <!-- Sisyphus 3D Container -->
    <div id="sisyphus-container"></div>
    
    <!-- Main Application -->
    <div class="relative z-10 min-h-screen" x-cloak>
        
        <!-- Header -->
        <header class="sticky top-0 z-50 glassmorphism">
            <div class="max-w-7xl mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-full bg-gradient-to-br from-chronext-gold to-chronext-rosegold flex items-center justify-center">
                            <i data-lucide="watch" class="w-5 h-5 text-chronext-dark"></i>
                        </div>
                        <div>
                            <h1 class="font-cinzel text-xl font-semibold tracking-wide text-gradient-gold">INTERVENTION CENTER</h1>
                            <p class="text-xs text-chronext-platinum/50 font-inter">Chronext Escalation Management</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <!-- Ticket Counter -->
                        <div class="glassmorphism-light rounded-lg px-4 py-2 flex items-center gap-3">
                            <span class="text-xs text-chronext-platinum/60 uppercase tracking-wider">Active</span>
                            <span class="font-cinzel text-2xl font-bold" :class="activeTickets.length === 0 ? 'text-green-400' : 'text-chronext-gold'" x-text="activeTickets.length"></span>
                        </div>
                        
                        <!-- Sync Button -->
                        <button @click="syncData()" class="magnetic-btn glassmorphism-light rounded-lg px-4 py-2 flex items-center gap-2 hover:bg-chronext-gold/10" :class="{'animate-spin': syncing}">
                            <i data-lucide="refresh-cw" class="w-4 h-4" :class="syncing ? 'animate-spin' : ''"></i>
                            <span class="text-sm" x-text="syncing ? 'Syncing...' : 'Sync'"></span>
                        </button>
                        
                        <!-- Add Ticket Button -->
                        <button @click="showInputModal = true" class="magnetic-btn bg-gradient-to-r from-chronext-gold to-chronext-rosegold text-chronext-dark rounded-lg px-5 py-2 font-semibold text-sm flex items-center gap-2">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            Parse Input
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Sisyphus Progress Bar -->
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="glassmorphism rounded-xl p-4">
                <div class="flex items-center justify-between mb-2">
                    <div class="flex items-center gap-2">
                        <span class="text-xs text-chronext-platinum/60 uppercase tracking-wider">Sisyphus Progress</span>
                        <span class="text-xs text-chronext-gold" x-text="getMotivationalQuote()"></span>
                    </div>
                    <span class="font-cinzel text-sm" x-text="Math.round(sisyphusProgress) + '% zum Gipfel'"></span>
                </div>
                <div class="h-2 bg-chronext-dark rounded-full overflow-hidden">
                    <div class="h-full bg-gradient-to-r from-chronext-gold via-chronext-rosegold to-chronext-platinum rounded-full transition-all duration-1000 ease-out" :style="'width: ' + sisyphusProgress + '%'"></div>
                </div>
            </div>
        </div>
        
        <!-- Critical Tickets (Tier 1) - Fixed Above Fold -->
        <template x-if="criticalTickets.length > 0">
            <div class="max-w-7xl mx-auto px-6 py-4">
                <div class="mb-4 flex items-center gap-2">
                    <i data-lucide="alert-triangle" class="w-5 h-5 text-chronext-crimson"></i>
                    <h2 class="font-cinzel text-lg tracking-wider text-chronext-crimson">KRITISCHE ESKALATIONEN</h2>
                </div>
                <div class="grid gap-4">
                    <template x-for="ticket in criticalTickets" :key="ticket.id">
                        <div class="ticket-card glassmorphism rounded-xl p-5 pulse-critical border-l-4 border-chronext-crimson" x-data="{expanded: false, editing: false}">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <div class="flex items-center gap-3 mb-2">
                                        <span class="category-badge px-2 py-1 rounded bg-chronext-crimson/20 text-chronext-crimson uppercase font-semibold" x-text="ticket.category"></span>
                                        <span class="category-badge px-2 py-1 rounded bg-chronext-gold/20 text-chronext-gold uppercase" x-text="'Prio ' + ticket.priority"></span>
                                        <span class="text-xs text-chronext-platinum/40" x-text="formatTimestamp(ticket.timestamp)"></span>
                                    </div>
                                    <h3 class="font-cinzel text-lg mb-1" x-text="ticket.clientName || 'Unbekannter Kunde'"></h3>
                                    <p class="text-sm text-chronext-platinum/70 mb-3" x-text="ticket.problem"></p>
                                    
                                    <!-- Expandable Details -->
                                    <div x-show="expanded" x-collapse class="mt-4 pt-4 border-t border-chronext-platinum/10">
                                        <template x-if="ticket.context">
                                            <p class="text-xs text-chronext-platinum/50 mb-3" x-text="ticket.context"></p>
                                        </template>
                                        <template x-if="ticket.phone">
                                            <div class="flex items-center gap-2 mb-2">
                                                <i data-lucide="phone" class="w-4 h-4 text-chronext-gold"></i>
                                                <span class="text-sm cursor-pointer hover:text-chronext-gold transition-colors" @click="copyToClipboard(ticket.phone)" x-text="ticket.phone"></span>
                                            </div>
                                        </template>
                                        <template x-if="ticket.iban">
                                            <div class="flex items-center gap-2 mb-2">
                                                <i data-lucide="credit-card" class="w-4 h-4 text-chronext-gold"></i>
                                                <span class="text-sm cursor-pointer hover:text-chronext-gold transition-colors" @click="copyToClipboard(ticket.iban)" x-text="ticket.iban"></span>
                                            </div>
                                        </template>
                                        <template x-if="ticket.srNumber">
                                            <div class="flex items-center gap-2 mb-2">
                                                <i data-lucide="hash" class="w-4 h-4 text-chronext-platinum/50"></i>
                                                <span class="text-xs text-chronext-platinum/50" x-text="'SR: ' + ticket.srNumber"></span>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                                
                                <div class="flex items-center gap-2 ml-4">
                                    <template x-for="link in ticket.links" :key="link">
                                        <a :href="link" target="_blank" class="magnetic-btn glassmorphism-light rounded-lg px-3 py-2 text-xs hover:bg-chronext-gold/10 flex items-center gap-1">
                                            <i data-lucide="external-link" class="w-3 h-3"></i>
                                            <span x-text="getLinkLabel(link)"></span>
                                        </a>
                                    </template>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between mt-4 pt-4 border-t border-chronext-platinum/10">
                                <button @click="expanded = !expanded" class="text-xs text-chronext-platinum/50 hover:text-chronext-gold transition-colors flex items-center gap-1">
                                    <i data-lucide="chevron-down" class="w-4 h-4 transition-transform" :class="expanded ? 'rotate-180' : ''"></i>
                                    <span x-text="expanded ? 'Weniger' : 'Details'"></span>
                                </button>
                                
                                <div class="flex items-center gap-2">
                                    <button @click="editTicket(ticket)" class="magnetic-btn glassmorphism-light rounded-lg px-3 py-1.5 text-xs hover:bg-chronext-platinum/10">
                                        <i data-lucide="edit-2" class="w-3 h-3"></i>
                                    </button>
                                    <button @click="dismissTicket(ticket.id)" class="magnetic-btn bg-green-500/20 text-green-400 rounded-lg px-4 py-1.5 text-xs font-semibold hover:bg-green-500/30">
                                        Erledigt
                                    </button>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </template>
        
        <!-- Category Filter Tabs -->
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center gap-2 overflow-x-auto scrollbar-hide pb-2">
                <button @click="activeFilter = 'all'" class="magnetic-btn whitespace-nowrap px-4 py-2 rounded-lg text-sm transition-all" :class="activeFilter === 'all' ? 'bg-chronext-gold text-chronext-dark font-semibold' : 'glassmorphism-light hover:bg-chronext-gold/10'">
                    Alle (<span x-text="activeTickets.length"></span>)
                </button>
                <button @click="activeFilter = 'finance'" class="magnetic-btn whitespace-nowrap px-4 py-2 rounded-lg text-sm transition-all flex items-center gap-2" :class="activeFilter === 'finance' ? 'bg-chronext-gold text-chronext-dark font-semibold' : 'glassmorphism-light hover:bg-chronext-gold/10'">
                    <i data-lucide="banknote" class="w-4 h-4"></i>
                    Finance (<span x-text="getTicketsByCategory('finance').length"></span>)
                </button>
                <button @click="activeFilter = 'legal'" class="magnetic-btn whitespace-nowrap px-4 py-2 rounded-lg text-sm transition-all flex items-center gap-2" :class="activeFilter === 'legal' ? 'bg-chronext-crimson text-white font-semibold' : 'glassmorphism-light hover:bg-chronext-crimson/10'">
                    <i data-lucide="scale" class="w-4 h-4"></i>
                    Legal (<span x-text="getTicketsByCategory('legal').length"></span>)
                </button>
                <button @click="activeFilter = 'logistics'" class="magnetic-btn whitespace-nowrap px-4 py-2 rounded-lg text-sm transition-all flex items-center gap-2" :class="activeFilter === 'logistics' ? 'bg-chronext-gold text-chronext-dark font-semibold' : 'glassmorphism-light hover:bg-chronext-gold/10'">
                    <i data-lucide="truck" class="w-4 h-4"></i>
                    Logistics (<span x-text="getTicketsByCategory('logistics').length"></span>)
                </button>
                <button @click="activeFilter = 'update'" class="magnetic-btn whitespace-nowrap px-4 py-2 rounded-lg text-sm transition-all flex items-center gap-2" :class="activeFilter === 'update' ? 'bg-chronext-gold text-chronext-dark font-semibold' : 'glassmorphism-light hover:bg-chronext-gold/10'">
                    <i data-lucide="message-circle" class="w-4 h-4"></i>
                    Update (<span x-text="getTicketsByCategory('update').length"></span>)
                </button>
            </div>
        </div>
        
        <!-- Main Ticket Grid -->
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                <template x-for="ticket in filteredTickets" :key="ticket.id">
                    <div class="ticket-card glassmorphism rounded-xl p-5" 
                         :class="{'pulse-warning border-l-4 border-chronext-rosegold': ticket.priority >= 6 && ticket.priority < 9, 'border-l-4 border-chronext-platinum/30': ticket.priority < 6}"
                         x-data="{expanded: false}">
                        <div class="flex items-center gap-2 mb-3">
                            <span class="category-badge px-2 py-1 rounded uppercase font-semibold"
                                  :class="{
                                      'bg-chronext-crimson/20 text-chronext-crimson': ticket.category === 'legal',
                                      'bg-chronext-gold/20 text-chronext-gold': ticket.category === 'finance',
                                      'bg-blue-500/20 text-blue-400': ticket.category === 'logistics',
                                      'bg-chronext-platinum/20 text-chronext-platinum': ticket.category === 'update'
                                  }"
                                  x-text="ticket.category"></span>
                            <span class="category-badge px-2 py-1 rounded bg-chronext-anthracite text-chronext-platinum/60" x-text="'P' + ticket.priority"></span>
                        </div>
                        
                        <h3 class="font-cinzel text-base mb-2" x-text="ticket.clientName || 'Kunde'"></h3>
                        <p class="text-sm text-chronext-platinum/70 mb-3 line-clamp-2" x-text="ticket.problem"></p>
                        
                        <!-- Quick Links -->
                        <div class="flex flex-wrap gap-2 mb-3">
                            <template x-for="link in ticket.links?.slice(0, 2)" :key="link">
                                <a :href="link" target="_blank" class="text-xs text-chronext-gold hover:underline flex items-center gap-1">
                                    <i data-lucide="external-link" class="w-3 h-3"></i>
                                    <span x-text="getLinkLabel(link)"></span>
                                </a>
                            </template>
                        </div>
                        
                        <!-- Expanded Details -->
                        <div x-show="expanded" x-collapse class="pt-3 border-t border-chronext-platinum/10">
                            <template x-if="ticket.context">
                                <p class="text-xs text-chronext-platinum/50 mb-2" x-text="ticket.context"></p>
                            </template>
                            <template x-if="ticket.phone">
                                <div class="flex items-center gap-2 mb-1 cursor-pointer hover:text-chronext-gold" @click="copyToClipboard(ticket.phone)">
                                    <i data-lucide="phone" class="w-3 h-3"></i>
                                    <span class="text-xs" x-text="ticket.phone"></span>
                                </div>
                            </template>
                            <template x-if="ticket.timeInfo">
                                <div class="flex items-center gap-2 mb-1 text-chronext-rosegold">
                                    <i data-lucide="clock" class="w-3 h-3"></i>
                                    <span class="text-xs" x-text="ticket.timeInfo"></span>
                                </div>
                            </template>
                        </div>
                        
                        <div class="flex items-center justify-between mt-3 pt-3 border-t border-chronext-platinum/10">
                            <button @click="expanded = !expanded" class="text-xs text-chronext-platinum/50 hover:text-chronext-gold flex items-center gap-1">
                                <i data-lucide="chevron-down" class="w-3 h-3" :class="expanded ? 'rotate-180' : ''"></i>
                                <span x-text="expanded ? 'Weniger' : 'Mehr'"></span>
                            </button>
                            <div class="flex items-center gap-2">
                                <button @click="editTicket(ticket)" class="p-1.5 rounded hover:bg-chronext-platinum/10">
                                    <i data-lucide="edit-2" class="w-3 h-3"></i>
                                </button>
                                <button @click="dismissTicket(ticket.id)" class="magnetic-btn bg-green-500/20 text-green-400 rounded px-3 py-1 text-xs font-semibold hover:bg-green-500/30">
                                    ✓
                                </button>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
            
            <!-- Empty State -->
            <template x-if="activeTickets.length === 0 && !showZeroInboxCelebration">
                <div class="text-center py-20">
                    <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-chronext-gold to-chronext-rosegold flex items-center justify-center">
                        <i data-lucide="check-circle" class="w-10 h-10 text-chronext-dark"></i>
                    </div>
                    <h3 class="font-cinzel text-2xl mb-2 text-gradient-gold">Zero Inbox Achieved</h3>
                    <p class="text-chronext-platinum/60 text-sm italic">"Do better if possible, and that is always possible." — Vacheron Constantin</p>
                </div>
            </template>
        </div>
        
        <!-- Input Modal -->
        <div x-show="showInputModal" x-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4" x-transition>
            <div class="absolute inset-0 bg-black/80" @click="showInputModal = false"></div>
            <div class="relative glassmorphism rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden" @click.stop>
                <div class="p-6 border-b border-chronext-platinum/10">
                    <div class="flex items-center justify-between">
                        <h2 class="font-cinzel text-xl text-gradient-gold">Intervention Parser</h2>
                        <button @click="showInputModal = false" class="p-2 rounded-lg hover:bg-chronext-platinum/10">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                    <p class="text-xs text-chronext-platinum/50 mt-1">Füge deinen Text ein — E-Mails, Slack-Nachrichten, Telefonnotizen</p>
                </div>
                
                <div class="p-6 overflow-y-auto max-h-[60vh]">
                    <textarea x-model="rawInput" 
                              class="w-full h-64 bg-chronext-dark/50 border border-chronext-platinum/20 rounded-xl p-4 text-sm text-chronext-platinum focus:border-chronext-gold focus:outline-none resize-none"
                              placeholder="Beispiel:
Herr Pempelforth wird das heute Abend zum Anwalt geben wenn du keine Rückmeldung für Ihn hast

Bitte dem Kunden die Uhr zurückgeben: https://operations.chronext.com/sell/details/SR409856132

+492681989056 , Bitte den Herr Sommer zurückrufen"></textarea>
                    
                    <div class="mt-4 flex items-center justify-between">
                        <div class="text-xs text-chronext-platinum/40">
                            <span x-text="rawInput.length"></span> Zeichen
                        </div>
                        <button @click="parseInput()" class="magnetic-btn bg-gradient-to-r from-chronext-gold to-chronext-rosegold text-chronext-dark rounded-lg px-6 py-2 font-semibold text-sm flex items-center gap-2">
                            <i data-lucide="sparkles" class="w-4 h-4"></i>
                            Parse & Import
                        </button>
                    </div>
                </div>
                
                <!-- Preview of parsed tickets -->
                <template x-if="parsedPreview.length > 0">
                    <div class="p-6 border-t border-chronext-platinum/10 bg-chronext-dark/30">
                        <h3 class="text-sm font-semibold mb-3">Erkannte Tickets (<span x-text="parsedPreview.length"></span>)</h3>
                        <div class="space-y-2 max-h-40 overflow-y-auto">
                            <template x-for="(preview, idx) in parsedPreview" :key="idx">
                                <div class="glassmorphism-light rounded-lg p-3 text-xs">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="px-1.5 py-0.5 rounded text-[10px] uppercase font-semibold"
                                              :class="{
                                                  'bg-chronext-crimson/20 text-chronext-crimson': preview.category === 'legal',
                                                  'bg-chronext-gold/20 text-chronext-gold': preview.category === 'finance',
                                                  'bg-blue-500/20 text-blue-400': preview.category === 'logistics',
                                                  'bg-chronext-platinum/20 text-chronext-platinum': preview.category === 'update'
                                              }"
                                              x-text="preview.category"></span>
                                        <span class="font-semibold" x-text="preview.clientName || 'Kunde'"></span>
                                    </div>
                                    <p class="text-chronext-platinum/60 truncate" x-text="preview.problem"></p>
                                </div>
                            </template>
                        </div>
                        <button @click="confirmImport()" class="mt-4 w-full magnetic-btn bg-green-500/20 text-green-400 rounded-lg py-2 font-semibold text-sm hover:bg-green-500/30">
                            Alle Importieren
                        </button>
                    </div>
                </template>
            </div>
        </div>
        
        <!-- Edit Modal -->
        <div x-show="showEditModal" x-cloak class="fixed inset-0 z-50 flex items-center justify-center p-4" x-transition>
            <div class="absolute inset-0 bg-black/80" @click="showEditModal = false"></div>
            <div class="relative glassmorphism rounded-2xl w-full max-w-lg" @click.stop>
                <div class="p-6 border-b border-chronext-platinum/10">
                    <h2 class="font-cinzel text-xl text-gradient-gold">Ticket Bearbeiten</h2>
                </div>
                <div class="p-6 space-y-4">
                    <div>
                        <label class="text-xs text-chronext-platinum/60 uppercase tracking-wider">Kundenname</label>
                        <input type="text" x-model="editingTicket.clientName" class="w-full mt-1 bg-chronext-dark/50 border border-chronext-platinum/20 rounded-lg px-4 py-2 text-sm focus:border-chronext-gold focus:outline-none">
                    </div>
                    <div>
                        <label class="text-xs text-chronext-platinum/60 uppercase tracking-wider">Problem</label>
                        <textarea x-model="editingTicket.problem" class="w-full mt-1 bg-chronext-dark/50 border border-chronext-platinum/20 rounded-lg px-4 py-2 text-sm focus:border-chronext-gold focus:outline-none h-24 resize-none"></textarea>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-xs text-chronext-platinum/60 uppercase tracking-wider">Kategorie</label>
                            <select x-model="editingTicket.category" class="w-full mt-1 bg-chronext-dark/50 border border-chronext-platinum/20 rounded-lg px-4 py-2 text-sm focus:border-chronext-gold focus:outline-none">
                                <option value="finance">Finance</option>
                                <option value="legal">Legal</option>
                                <option value="logistics">Logistics</option>
                                <option value="update">Update</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-xs text-chronext-platinum/60 uppercase tracking-wider">Priorität (1-10)</label>
                            <input type="number" min="1" max="10" x-model="editingTicket.priority" class="w-full mt-1 bg-chronext-dark/50 border border-chronext-platinum/20 rounded-lg px-4 py-2 text-sm focus:border-chronext-gold focus:outline-none">
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-chronext-platinum/60 uppercase tracking-wider">Telefon</label>
                        <input type="text" x-model="editingTicket.phone" class="w-full mt-1 bg-chronext-dark/50 border border-chronext-platinum/20 rounded-lg px-4 py-2 text-sm focus:border-chronext-gold focus:outline-none">
                    </div>
                    <div>
                        <label class="text-xs text-chronext-platinum/60 uppercase tracking-wider">Kontext / Notizen</label>
                        <textarea x-model="editingTicket.context" class="w-full mt-1 bg-chronext-dark/50 border border-chronext-platinum/20 rounded-lg px-4 py-2 text-sm focus:border-chronext-gold focus:outline-none h-20 resize-none"></textarea>
                    </div>
                </div>
                <div class="p-6 border-t border-chronext-platinum/10 flex justify-end gap-3">
                    <button @click="showEditModal = false" class="px-4 py-2 rounded-lg text-sm hover:bg-chronext-platinum/10">Abbrechen</button>
                    <button @click="saveEditedTicket()" class="magnetic-btn bg-gradient-to-r from-chronext-gold to-chronext-rosegold text-chronext-dark rounded-lg px-6 py-2 font-semibold text-sm">Speichern</button>
                </div>
            </div>
        </div>
        
        <!-- Zero Inbox Celebration -->
        <div x-show="showZeroInboxCelebration" x-cloak class="fixed inset-0 z-[100] flex items-center justify-center" x-transition:enter="transition ease-out duration-1000" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100">
            <div class="absolute inset-0 bg-chronext-dark/95"></div>
            <div class="relative text-center max-w-2xl mx-auto px-6">
                <div class="mb-8">
                    <img :src="celebrationWatch.image" alt="Luxury Watch" class="w-80 h-auto mx-auto rounded-lg shadow-2xl" style="filter: drop-shadow(0 0 60px rgba(212, 175, 55, 0.3));">
                </div>
                <h2 class="font-cinzel text-3xl md:text-4xl mb-6 text-gradient-gold">Sisyphus hat den Gipfel erreicht.</h2>
                <blockquote class="text-xl md:text-2xl italic text-chronext-platinum/80 mb-4" x-text="'\"' + celebrationWatch.quote + '\"'"></blockquote>
                <p class="text-sm text-chronext-gold mb-8" x-text="'— ' + celebrationWatch.brand"></p>
                <button @click="showZeroInboxCelebration = false" class="magnetic-btn bg-gradient-to-r from-chronext-gold to-chronext-rosegold text-chronext-dark rounded-lg px-8 py-3 font-semibold">
                    Zurück zum Dashboard
                </button>
            </div>
        </div>
        
        <!-- Copy Notification Toast -->
        <div x-show="showCopyToast" x-cloak class="fixed bottom-6 right-6 z-50 glassmorphism rounded-lg px-4 py-3 flex items-center gap-2 copy-notification" x-transition>
            <i data-lucide="check" class="w-4 h-4 text-green-400"></i>
            <span class="text-sm">Kopiert!</span>
        </div>
        
        <!-- Footer Quote -->
        <footer class="max-w-7xl mx-auto px-6 py-8 text-center">
            <p class="text-xs text-chronext-platinum/30 italic" x-text="'\"' + footerQuote + '\"'"></p>
        </footer>
    </div>
    
    <script>
        // Haute Horlogerie Quotes & Easter Eggs
        const HORLOGERIE_QUOTES = [
            { quote: "You never actually own a Patek Philippe. You merely look after it for the next generation.", brand: "Patek Philippe" },
            { quote: "Do better if possible, and that is always possible.", brand: "Vacheron Constantin" },
            { quote: "To break the rules, you must first master them.", brand: "Audemars Piguet" },
            { quote: "Never stand still.", brand: "A. Lange & Söhne" },
            { quote: "The watchmaker of watchmakers.", brand: "Jaeger-LeCoultre" },
            { quote: "Innovation is our tradition.", brand: "Breguet" },
            { quote: "Time is measured in Rolex.", brand: "Rolex" },
            { quote: "A blend of tradition and innovation.", brand: "Omega" },
            { quote: "Mastery requires patience.", brand: "Chronext" },
            { quote: "Precision is not an act, but a habit.", brand: "Grand Seiko" },
            { quote: "The pursuit of perfection.", brand: "Patek Philippe" },
            { quote: "Crafted for eternity.", brand: "A. Lange & Söhne" }
        ];
        
        const CELEBRATION_WATCHES = [
            { image: "https://cdn.abacus.ai/images/f8b9bfff-8472-485c-8efb-b25912a5ca72.png", quote: "You never actually own a Patek Philippe. You merely look after it for the next generation.", brand: "Patek Philippe" },
            { image: "https://cdn.abacus.ai/images/a2e55d58-702a-4db3-a063-525c8b841f31.png", quote: "Never stand still.", brand: "A. Lange & Söhne" },
            { image: "https://cdn.abacus.ai/images/a31f4b09-171c-4d53-8623-e63079716210.png", quote: "To break the rules, you must first master them.", brand: "Audemars Piguet" }
        ];
        
        const MOTIVATIONAL_QUOTES = [
            "Jedes Ticket ein Schritt näher zum Gipfel.",
            "Präzision in jeder Handlung.",
            "Der Berg wird kleiner mit jedem erledigten Fall.",
            "Excellence ist keine Handlung, sondern eine Gewohnheit.",
            "Sisyphus glaubt an dich."
        ];
        
        // JSONBin Configuration
        const JSONBIN_CONFIG = {
            binId: '69720580d0ea881f407ce731',
            apiKey: '$2a$10$uZjLCrb.jtlcfCjmO6JA4OHV6j/2GeFfKlu6t8ymsR2V1LWGF0R32'
        };
        
        function interventionDashboard() {
            return {
                tickets: [],
                activeFilter: 'all',
                rawInput: '',
                parsedPreview: [],
                showInputModal: false,
                showEditModal: false,
                showZeroInboxCelebration: false,
                showCopyToast: false,
                editingTicket: {},
                syncing: false,
                footerQuote: HORLOGERIE_QUOTES[Math.floor(Math.random() * HORLOGERIE_QUOTES.length)].quote,
                celebrationWatch: CELEBRATION_WATCHES[0],
                sisyphusProgress: 0,
                totalInitialTickets: 10,
                
                get activeTickets() {
                    return this.tickets?.filter(t => !t?.dismissed) ?? [];
                },
                
                get criticalTickets() {
                    return this.activeTickets?.filter(t => (t?.priority ?? 0) >= 9) ?? [];
                },
                
                get filteredTickets() {
                    let filtered = this.activeTickets?.filter(t => (t?.priority ?? 0) < 9) ?? [];
                    if (this.activeFilter !== 'all') {
                        filtered = filtered?.filter(t => t?.category === this.activeFilter) ?? [];
                    }
                    return filtered?.sort((a, b) => (b?.priority ?? 0) - (a?.priority ?? 0)) ?? [];
                },
                
                async init() {
                    // Check for reset parameter or if all tickets are dismissed
                    const urlParams = new URLSearchParams(window.location.search);
                    const forceReset = urlParams.get('reset') === '1';
                    
                    if (forceReset) {
                        localStorage.removeItem('chronext_tickets');
                        window.history.replaceState({}, '', window.location.pathname);
                    }
                    
                    // Pre-load demo tickets if localStorage is empty or has no active tickets
                    let stored = localStorage.getItem('chronext_tickets');
                    let needsDemo = !stored;
                    
                    if (stored) {
                        try {
                            const parsed = JSON.parse(stored);
                            const activeCount = (parsed?.tickets ?? []).filter(t => !t?.dismissed).length;
                            needsDemo = activeCount === 0 && (parsed?.tickets?.length ?? 0) === 0;
                        } catch (e) {
                            needsDemo = true;
                        }
                    }
                    
                    if (needsDemo || forceReset) {
                        console.log('Loading demo tickets...');
                        const demoTickets = [
                            {
                                id: "demo1",
                                clientName: "Herr Pempelforth",
                                problem: "Wird das heute Abend zum Anwalt geben wenn keine Rückmeldung kommt",
                                category: "legal",
                                priority: 10,
                                links: [],
                                phone: null,
                                context: "DRINGEND! Anwaltsdrohung für heute Abend",
                                timestamp: new Date().toISOString(),
                                dismissed: false,
                                timeInfo: "heute Abend"
                            },
                            {
                                id: "demo2",
                                clientName: "Adrian Nieslony",
                                problem: "DHL hat sich nach 2 min aus dem Staub gemacht. Bitte Abholung neu terminieren",
                                category: "logistics",
                                priority: 7,
                                links: ["https://chronextag.myfreshworks.com/crm/sales/contacts/31127156824"],
                                phone: null,
                                context: "Hat schon mehrfach angerufen",
                                timestamp: new Date().toISOString(),
                                dismissed: false
                            },
                            {
                                id: "demo3",
                                clientName: "Herr Sommer",
                                problem: "Möchte eine Uhr verkaufen für einen Kunden der kein Internet benutzt",
                                category: "update",
                                priority: 5,
                                links: [],
                                phone: "+492681989056",
                                context: "Will nur kurz sprechen",
                                timestamp: new Date().toISOString(),
                                dismissed: false
                            },
                            {
                                id: "demo4",
                                clientName: "KLAUS VELTEN",
                                problem: "Erwartet Rückruf am Mittwoch",
                                category: "update",
                                priority: 5,
                                links: ["https://chronextag.myfreshworks.com/crm/sales/contacts/31122596165"],
                                phone: null,
                                context: "",
                                timestamp: new Date().toISOString(),
                                dismissed: false
                            },
                            {
                                id: "demo5",
                                clientName: "Herr Stettler",
                                problem: "Rückmeldung geben sonst Uhr zurücksenden",
                                category: "logistics",
                                priority: 7,
                                links: ["https://chronextsupport.freshdesk.com/a/tickets/2091694"],
                                phone: null,
                                context: "",
                                timestamp: new Date().toISOString(),
                                dismissed: false
                            },
                            {
                                id: "demo6",
                                clientName: "Kunde SR498013672",
                                problem: "Bitte Uhr zurücksenden",
                                category: "logistics",
                                priority: 6,
                                links: ["https://operations.chronext.com/sell/details/SR498013672"],
                                srNumber: "SR498013672",
                                phone: null,
                                context: "",
                                timestamp: new Date().toISOString(),
                                dismissed: false
                            },
                            {
                                id: "demo7",
                                clientName: "Kunde Finance",
                                problem: "Will klare Info warum Auszahlung länger dauert",
                                category: "finance",
                                priority: 8,
                                links: ["https://chronextag.myfreshworks.com/crm/sales/contacts/31047667688"],
                                phone: null,
                                context: "Braucht klare Kommunikation",
                                timestamp: new Date().toISOString(),
                                dismissed: false
                            },
                            {
                                id: "demo8",
                                clientName: "Kunde SR409856132",
                                problem: "Bitte Uhr zurückgeben",
                                category: "logistics",
                                priority: 6,
                                links: ["https://operations.chronext.com/sell/details/SR409856132"],
                                srNumber: "SR409856132",
                                phone: null,
                                context: "",
                                timestamp: new Date().toISOString(),
                                dismissed: false
                            }
                        ];
                        localStorage.setItem('chronext_tickets', JSON.stringify({ tickets: demoTickets }));
                        this.tickets = demoTickets;
                        this.totalInitialTickets = demoTickets.length;
                        console.log('Demo tickets loaded:', demoTickets.length);
                    } else {
                        await this.loadData();
                    }
                    
                    if (this.tickets?.length === 0) {
                        await this.loadData();
                    }
                    this.updateSisyphusProgress();
                    this.initThreeJS();
                    this.initSisyphus();
                    lucide.createIcons();
                    
                    // Watch for ticket changes
                    this.$watch('activeTickets', (value) => {
                        this.updateSisyphusProgress();
                        if (value?.length === 0 && this.tickets?.length > 0) {
                            this.triggerZeroInboxCelebration();
                        }
                    });
                },
                
                async loadData() {
                    // Try JSONBin first, fallback to localStorage
                    try {
                        const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_CONFIG.binId}/latest`, {
                            headers: { 'X-Access-Key': JSONBIN_CONFIG.apiKey }
                        });
                        if (response.ok) {
                            const data = await response.json();
                            this.tickets = data?.record?.tickets ?? [];
                            this.totalInitialTickets = Math.max(this.totalInitialTickets, this.tickets?.length ?? 0);
                            console.log('✓ Loaded from JSONBin Cloud');
                            return;
                        }
                    } catch (error) {
                        console.log('JSONBin nicht verfügbar, nutze localStorage');
                    }
                    
                    // Fallback to localStorage
                    try {
                        const stored = localStorage.getItem('chronext_tickets');
                        if (stored) {
                            this.tickets = JSON.parse(stored)?.tickets ?? [];
                            this.totalInitialTickets = Math.max(this.totalInitialTickets, this.tickets?.length ?? 0);
                        }
                    } catch (e) {
                        this.tickets = [];
                    }
                },
                
                async saveData() {
                    // Try JSONBin first
                    try {
                        const response = await fetch(`https://api.jsonbin.io/v3/b/${JSONBIN_CONFIG.binId}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json',
                                'X-Access-Key': JSONBIN_CONFIG.apiKey
                            },
                            body: JSON.stringify({ tickets: this.tickets ?? [] })
                        });
                        if (response.ok) {
                            console.log('✓ Saved to JSONBin Cloud');
                            return;
                        }
                    } catch (error) {
                        console.log('JSONBin speichern fehlgeschlagen, nutze localStorage');
                    }
                    
                    // Fallback to localStorage
                    try {
                        localStorage.setItem('chronext_tickets', JSON.stringify({ tickets: this.tickets ?? [] }));
                        console.log('✓ Saved to localStorage');
                    } catch (e) {
                        console.error('Save error:', e);
                    }
                },
                
                async syncData() {
                    this.syncing = true;
                    await this.saveData();
                    await this.loadData();
                    setTimeout(() => { this.syncing = false; }, 1000);
                },
                
                parseInput() {
                    const text = this.rawInput?.trim() ?? '';
                    if (!text) return;
                    
                    // Split by double newlines or specific patterns
                    const blocks = text.split(/\n{2,}|(?=Bitte)|(?=Please)|(?=Herr\s)|(?=Frau\s)|(?=\+49)/g)
                        .map(b => b?.trim())
                        .filter(b => b && b?.length > 10);
                    
                    this.parsedPreview = blocks?.map(block => this.parseTicketBlock(block)) ?? [];
                    lucide.createIcons();
                },
                
                parseTicketBlock(block) {
                    const ticket = {
                        id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                        clientName: '',
                        problem: block,
                        category: 'update',
                        priority: 5,
                        links: [],
                        phone: null,
                        iban: null,
                        srNumber: null,
                        poNumber: null,
                        timeInfo: null,
                        context: '',
                        timestamp: new Date().toISOString(),
                        dismissed: false
                    };
                    
                    // Extract names
                    const namePatterns = [
                        /(?:Herr|Frau)\s+([A-ZÄÖÜ][a-zäöüß]+)/gi,
                        /([A-ZÄÖÜ][A-ZÄÖÜ]+\s+[A-ZÄÖÜ][A-ZÄÖÜ]+)/g,
                        /([A-ZÄÖÜ][a-zäöüß]+\s+[A-ZÄÖÜ][a-zäöüß]+)/g
                    ];
                    for (const pattern of namePatterns) {
                        const match = block?.match(pattern);
                        if (match?.[0]) {
                            ticket.clientName = match[0]?.replace(/^(Herr|Frau)\s+/i, '')?.trim() ?? '';
                            break;
                        }
                    }
                    
                    // Extract links
                    const linkPattern = /https?:\/\/[^\s"<>]+/gi;
                    ticket.links = block?.match(linkPattern) ?? [];
                    
                    // Extract phone
                    const phonePattern = /\+?[0-9][0-9\s\-]{8,}/g;
                    const phoneMatch = block?.match(phonePattern);
                    if (phoneMatch?.[0]) ticket.phone = phoneMatch[0]?.trim() ?? null;
                    
                    // Extract SR/PO numbers
                    const srMatch = block?.match(/SR[0-9]+/i);
                    if (srMatch?.[0]) ticket.srNumber = srMatch[0] ?? null;
                    const poMatch = block?.match(/PO[0-9]+/i);
                    if (poMatch?.[0]) ticket.poNumber = poMatch[0] ?? null;
                    
                    // Extract IBAN
                    const ibanMatch = block?.match(/[A-Z]{2}[0-9]{2}[A-Z0-9]{4,}/i);
                    if (ibanMatch?.[0]) ticket.iban = ibanMatch[0] ?? null;
                    
                    // Detect category
                    const lowerBlock = block?.toLowerCase() ?? '';
                    if (/anwalt|betrug|rechtlich|klage|legal/.test(lowerBlock)) {
                        ticket.category = 'legal';
                        ticket.priority = 10;
                    } else if (/geld|auszahlung|iban|bezahlung|rechnung|kosten|finance/.test(lowerBlock)) {
                        ticket.category = 'finance';
                        ticket.priority = 7;
                    } else if (/dhl|abholung|zurücksenden|versand|logistics|zurückgeben|zurück senden/.test(lowerBlock)) {
                        ticket.category = 'logistics';
                        ticket.priority = 6;
                    } else {
                        ticket.category = 'update';
                        ticket.priority = 5;
                    }
                    
                    // Time-based priority boost
                    const timePatterns = [
                        { pattern: /seit\s+(oktober|november|dezember|januar)/i, boost: 3 },
                        { pattern: /vor\s+[2-9]\s+monaten?/i, boost: 3 },
                        { pattern: /vor\s+einem\s+monat/i, boost: 2 },
                        { pattern: /seit\s+monaten/i, boost: 3 },
                        { pattern: /wartet\s+schon\s+(sehr\s+)?lang/i, boost: 2 },
                        { pattern: /heute\s+abend/i, boost: 2 },
                        { pattern: /dringend|unbedingt|sofort/i, boost: 1 },
                        { pattern: /nächste\s+woche/i, boost: 1 }
                    ];
                    
                    for (const { pattern, boost } of timePatterns) {
                        if (pattern.test(lowerBlock)) {
                            ticket.priority = Math.min(10, (ticket.priority ?? 0) + boost);
                            const timeMatch = block?.match(pattern);
                            if (timeMatch?.[0]) ticket.timeInfo = timeMatch[0] ?? null;
                            break;
                        }
                    }
                    
                    // Create concise problem description
                    ticket.problem = block
                        ?.replace(/https?:\/\/[^\s"<>]+/gi, '')
                        ?.replace(/\s+/g, ' ')
                        ?.trim()
                        ?.substring(0, 200) ?? '';
                    
                    return ticket;
                },
                
                confirmImport() {
                    if (this.parsedPreview?.length > 0) {
                        this.tickets = [...(this.tickets ?? []), ...(this.parsedPreview ?? [])];
                        this.totalInitialTickets = Math.max(this.totalInitialTickets, this.tickets?.length ?? 0);
                        this.saveData();
                        this.parsedPreview = [];
                        this.rawInput = '';
                        this.showInputModal = false;
                        this.updateSisyphusProgress();
                        lucide.createIcons();
                    }
                },
                
                dismissTicket(id) {
                    const ticketEl = document.querySelector(`[data-ticket-id="${id}"]`)?.closest('.ticket-card');
                    const ticket = this.tickets?.find(t => t?.id === id);
                    if (ticket) {
                        // Animate dismiss
                        gsap.to(ticketEl || {}, {
                            scale: 0.8,
                            opacity: 0,
                            y: -20,
                            duration: 0.5,
                            ease: 'power2.inOut',
                            onComplete: () => {
                                ticket.dismissed = true;
                                this.saveData();
                                this.updateSisyphusProgress();
                            }
                        });
                    }
                },
                
                editTicket(ticket) {
                    this.editingTicket = { ...(ticket ?? {}) };
                    this.showEditModal = true;
                    setTimeout(() => lucide.createIcons(), 100);
                },
                
                saveEditedTicket() {
                    const index = this.tickets?.findIndex(t => t?.id === this.editingTicket?.id) ?? -1;
                    if (index !== -1 && this.tickets) {
                        this.tickets[index] = { ...this.editingTicket };
                        this.saveData();
                    }
                    this.showEditModal = false;
                    this.editingTicket = {};
                },
                
                getTicketsByCategory(category) {
                    return this.activeTickets?.filter(t => t?.category === category) ?? [];
                },
                
                getLinkLabel(link) {
                    if (!link) return 'Open';
                    if (link.includes('freshdesk')) return 'Freshdesk';
                    if (link.includes('freshworks') || link.includes('crm')) return 'CRM';
                    if (link.includes('operations')) return 'Operations';
                    return 'Open';
                },
                
                formatTimestamp(ts) {
                    if (!ts) return '';
                    try {
                        const date = new Date(ts);
                        return date.toLocaleDateString('de-DE', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit' });
                    } catch {
                        return '';
                    }
                },
                
                copyToClipboard(text) {
                    if (!text) return;
                    navigator.clipboard?.writeText(text)?.then(() => {
                        this.showCopyToast = true;
                        setTimeout(() => { this.showCopyToast = false; }, 2000);
                    })?.catch(console.error);
                },
                
                getMotivationalQuote() {
                    return MOTIVATIONAL_QUOTES[Math.floor(Math.random() * MOTIVATIONAL_QUOTES.length)] ?? '';
                },
                
                updateSisyphusProgress() {
                    const total = Math.max(1, this.totalInitialTickets);
                    const active = this.activeTickets?.length ?? 0;
                    const completed = total - active;
                    this.sisyphusProgress = Math.min(100, (completed / total) * 100);
                    
                    // Update Sisyphus 3D position
                    if (typeof updateSisyphusPosition === 'function') {
                        updateSisyphusPosition(this.sisyphusProgress / 100);
                    }
                },
                
                triggerZeroInboxCelebration() {
                    this.celebrationWatch = CELEBRATION_WATCHES[Math.floor(Math.random() * CELEBRATION_WATCHES.length)] ?? CELEBRATION_WATCHES[0];
                    setTimeout(() => {
                        this.showZeroInboxCelebration = true;
                    }, 800);
                },
                
                initThreeJS() {
                    const canvas = document.getElementById('bg-canvas');
                    if (!canvas) return;
                    
                    const scene = new THREE.Scene();
                    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                    const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
                    
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                    
                    // Floating geometric shapes
                    const shapes = [];
                    const geometries = [
                        new THREE.IcosahedronGeometry(0.5, 0),
                        new THREE.TorusKnotGeometry(0.3, 0.1, 64, 8),
                        new THREE.OctahedronGeometry(0.4, 0)
                    ];
                    
                    const material = new THREE.MeshPhysicalMaterial({
                        color: 0x1a1a24,
                        metalness: 0.9,
                        roughness: 0.1,
                        transmission: 0.5,
                        thickness: 0.5,
                        envMapIntensity: 1
                    });
                    
                    for (let i = 0; i < 15; i++) {
                        const geometry = geometries[Math.floor(Math.random() * geometries.length)];
                        const mesh = new THREE.Mesh(geometry, material.clone());
                        mesh.position.set(
                            (Math.random() - 0.5) * 20,
                            (Math.random() - 0.5) * 20,
                            (Math.random() - 0.5) * 10 - 5
                        );
                        mesh.rotation.set(
                            Math.random() * Math.PI,
                            Math.random() * Math.PI,
                            Math.random() * Math.PI
                        );
                        mesh.userData.rotationSpeed = {
                            x: (Math.random() - 0.5) * 0.005,
                            y: (Math.random() - 0.5) * 0.005
                        };
                        shapes.push(mesh);
                        scene.add(mesh);
                    }
                    
                    // Lighting
                    const ambientLight = new THREE.AmbientLight(0xffffff, 0.2);
                    scene.add(ambientLight);
                    
                    const pointLight1 = new THREE.PointLight(0xd4af37, 0.8);
                    pointLight1.position.set(5, 5, 5);
                    scene.add(pointLight1);
                    
                    const pointLight2 = new THREE.PointLight(0xb76e79, 0.5);
                    pointLight2.position.set(-5, -5, 5);
                    scene.add(pointLight2);
                    
                    camera.position.z = 5;
                    
                    // Mouse parallax
                    let mouseX = 0, mouseY = 0;
                    document.addEventListener('mousemove', (e) => {
                        mouseX = (e.clientX / window.innerWidth - 0.5) * 2;
                        mouseY = (e.clientY / window.innerHeight - 0.5) * 2;
                    });
                    
                    function animate() {
                        requestAnimationFrame(animate);
                        
                        shapes.forEach(shape => {
                            if (shape?.rotation && shape?.userData?.rotationSpeed) {
                                shape.rotation.x += shape.userData.rotationSpeed.x;
                                shape.rotation.y += shape.userData.rotationSpeed.y;
                            }
                        });
                        
                        camera.position.x += (mouseX * 0.5 - camera.position.x) * 0.02;
                        camera.position.y += (-mouseY * 0.5 - camera.position.y) * 0.02;
                        camera.lookAt(scene.position);
                        
                        renderer.render(scene, camera);
                    }
                    animate();
                    
                    window.addEventListener('resize', () => {
                        camera.aspect = window.innerWidth / window.innerHeight;
                        camera.updateProjectionMatrix();
                        renderer.setSize(window.innerWidth, window.innerHeight);
                    });
                },
                
                initSisyphus() {
                    const container = document.getElementById('sisyphus-container');
                    if (!container) return;
                    
                    const scene = new THREE.Scene();
                    const camera = new THREE.PerspectiveCamera(50, 300 / 400, 0.1, 1000);
                    const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
                    
                    renderer.setSize(300, 400);
                    container.appendChild(renderer.domElement);
                    
                    // Mountain (slope)
                    const mountainGeometry = new THREE.ConeGeometry(2, 4, 4);
                    const mountainMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0x1a1a24, 
                        flatShading: true,
                        transparent: true,
                        opacity: 0.8
                    });
                    const mountain = new THREE.Mesh(mountainGeometry, mountainMaterial);
                    mountain.position.set(0, -1, 0);
                    mountain.rotation.z = Math.PI;
                    scene.add(mountain);
                    
                    // Boulder
                    const boulderGeometry = new THREE.SphereGeometry(0.3, 16, 16);
                    const boulderMaterial = new THREE.MeshPhongMaterial({ 
                        color: 0xd4af37,
                        shininess: 100
                    });
                    const boulder = new THREE.Mesh(boulderGeometry, boulderMaterial);
                    boulder.position.set(-0.8, -1.5, 0);
                    scene.add(boulder);
                    
                    // Sisyphus (simple figure)
                    const bodyGeometry = new THREE.CapsuleGeometry(0.15, 0.4, 4, 8);
                    const bodyMaterial = new THREE.MeshPhongMaterial({ color: 0xe5e4e2 });
                    const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
                    body.position.set(-1.1, -1.6, 0);
                    body.rotation.z = Math.PI / 6;
                    scene.add(body);
                    
                    const headGeometry = new THREE.SphereGeometry(0.12, 16, 16);
                    const head = new THREE.Mesh(headGeometry, bodyMaterial);
                    head.position.set(-0.95, -1.2, 0);
                    scene.add(head);
                    
                    // Lighting
                    const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
                    scene.add(ambientLight);
                    
                    const directionalLight = new THREE.DirectionalLight(0xd4af37, 0.8);
                    directionalLight.position.set(5, 5, 5);
                    scene.add(directionalLight);
                    
                    camera.position.set(0, 0, 5);
                    camera.lookAt(0, -0.5, 0);
                    
                    // Store references for position updates
                    window.sisyphusScene = { boulder, body, head };
                    
                    window.updateSisyphusPosition = (progress) => {
                        if (!window.sisyphusScene) return;
                        const { boulder, body, head } = window.sisyphusScene;
                        
                        // Move up the mountain based on progress (0-1)
                        const yOffset = progress * 2.5;
                        const xOffset = progress * 1.5;
                        
                        if (boulder) {
                            boulder.position.y = -1.5 + yOffset;
                            boulder.position.x = -0.8 + xOffset;
                        }
                        if (body) {
                            body.position.y = -1.6 + yOffset;
                            body.position.x = -1.1 + xOffset;
                        }
                        if (head) {
                            head.position.y = -1.2 + yOffset;
                            head.position.x = -0.95 + xOffset;
                        }
                    };
                    
                    function animateSisyphus() {
                        requestAnimationFrame(animateSisyphus);
                        
                        // Subtle boulder rotation
                        if (boulder) {
                            boulder.rotation.z += 0.01;
                        }
                        
                        renderer.render(scene, camera);
                    }
                    animateSisyphus();
                }
            };
        }
    </script>
</body>
</html>
